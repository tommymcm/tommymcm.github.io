<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Analysis/CGSCCPassManager.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LLVM<span id="projectnumber">&#160;9.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a25db018342d3ae6c7e6779086c18378.html">Analysis</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">CGSCCPassManager.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="CGSCCPassManager_8h_source.html">llvm/Analysis/CGSCCPassManager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ArrayRef_8h_source.html">llvm/ADT/ArrayRef.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Optional_8h_source.html">llvm/ADT/Optional.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="STLExtras_8h_source.html">llvm/ADT/STLExtras.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="SetVector_8h_source.html">llvm/ADT/SetVector.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="SmallPtrSet_8h_source.html">llvm/ADT/SmallPtrSet.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="SmallVector_8h_source.html">llvm/ADT/SmallVector.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="iterator__range_8h_source.html">llvm/ADT/iterator_range.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="LazyCallGraph_8h_source.html">llvm/Analysis/LazyCallGraph.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="CallSite_8h_source.html">llvm/IR/CallSite.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Constant_8h_source.html">llvm/IR/Constant.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="InstIterator_8h_source.html">llvm/IR/InstIterator.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="IR_2Instruction_8h_source.html">llvm/IR/Instruction.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="PassManager_8h_source.html">llvm/IR/PassManager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Casting_8h_source.html">llvm/Support/Casting.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Debug_8h_source.html">llvm/Support/Debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="raw__ostream_8h_source.html">llvm/Support/raw_ostream.h</a>&quot;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;iterator&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for CGSCCPassManager.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="CGSCCPassManager_8cpp__incl.png" border="0" usemap="#alib_2Analysis_2CGSCCPassManager_8cpp" alt=""/></div>
</div>
</div>
<p><a href="CGSCCPassManager_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacellvm"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacellvm.html">llvm</a></td></tr>
<tr class="memdesc:namespacellvm"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents lattice values for constants. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad78e062f62e0d6e453941fb4ca843e4d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CGSCCPassManager_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>&#160;&#160;&#160;&quot;cgscc&quot;</td></tr>
<tr class="separator:ad78e062f62e0d6e453941fb4ca843e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a01907c1b6ed2149a74bf8ac740be7beb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CGSCCPassManager_8cpp.html#a01907c1b6ed2149a74bf8ac740be7beb">updateNewSCCFunctionAnalyses</a> (<a class="el" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;<a class="el" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <a class="el" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;<a class="el" href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="namespacellvm.html#abd17dd16e74c968cf01d3d32ea486696">CGSCCAnalysisManager</a> &amp;AM)</td></tr>
<tr class="memdesc:a01907c1b6ed2149a74bf8ac740be7beb"><td class="mdescLeft">&#160;</td><td class="mdescRight">When a new SCC is created for the graph and there might be function analysis results cached for the functions now in that SCC two forms of updates are required.  <a href="CGSCCPassManager_8cpp.html#a01907c1b6ed2149a74bf8ac740be7beb">More...</a><br /></td></tr>
<tr class="separator:a01907c1b6ed2149a74bf8ac740be7beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa64f6bcd5ace031369edc14aa406d745"><td class="memTemplParams" colspan="2">template&lt;typename SCCRangeT &gt; </td></tr>
<tr class="memitem:aa64f6bcd5ace031369edc14aa406d745"><td class="memTemplItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="CGSCCPassManager_8cpp.html#aa64f6bcd5ace031369edc14aa406d745">incorporateNewSCCRange</a> (<a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> SCCRangeT &amp;NewSCCRange, <a class="el" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;<a class="el" href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> &amp;<a class="el" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="el" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> *<a class="el" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <a class="el" href="namespacellvm.html#abd17dd16e74c968cf01d3d32ea486696">CGSCCAnalysisManager</a> &amp;AM, <a class="el" href="structllvm_1_1CGSCCUpdateResult.html">CGSCCUpdateResult</a> &amp;UR)</td></tr>
<tr class="memdesc:aa64f6bcd5ace031369edc14aa406d745"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to update both the <code>CGSCCAnalysisManager</code> <code>AM</code> and the <code>CGSCCPassManager's</code> <code>CGSCCUpdateResult</code> <code>UR</code> based on a range of newly added SCCs.  <a href="CGSCCPassManager_8cpp.html#aa64f6bcd5ace031369edc14aa406d745">More...</a><br /></td></tr>
<tr class="separator:aa64f6bcd5ace031369edc14aa406d745"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad78e062f62e0d6e453941fb4ca843e4d" name="ad78e062f62e0d6e453941fb4ca843e4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad78e062f62e0d6e453941fb4ca843e4d">&#9670;&nbsp;</a></span>DEBUG_TYPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_TYPE&#160;&#160;&#160;&quot;cgscc&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CGSCCPassManager_8cpp_source.html#l00030">30</a> of file <a class="el" href="CGSCCPassManager_8cpp_source.html">CGSCCPassManager.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa64f6bcd5ace031369edc14aa406d745" name="aa64f6bcd5ace031369edc14aa406d745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa64f6bcd5ace031369edc14aa406d745">&#9670;&nbsp;</a></span>incorporateNewSCCRange()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SCCRangeT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> * incorporateNewSCCRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> SCCRangeT &amp;&#160;</td>
          <td class="paramname"><em>NewSCCRange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> &amp;&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> *&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacellvm.html#abd17dd16e74c968cf01d3d32ea486696">CGSCCAnalysisManager</a> &amp;&#160;</td>
          <td class="paramname"><em>AM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structllvm_1_1CGSCCUpdateResult.html">CGSCCUpdateResult</a> &amp;&#160;</td>
          <td class="paramname"><em>UR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to update both the <code>CGSCCAnalysisManager</code> <code>AM</code> and the <code>CGSCCPassManager's</code> <code>CGSCCUpdateResult</code> <code>UR</code> based on a range of newly added SCCs. </p>
<p >The range of new SCCs must be in postorder already. The SCC they were split out of must be provided as <code>C</code>. The current node being mutated and triggering updates must be passed as <code>N</code>.</p>
<p >This function returns the SCC containing <code>N</code>. This will be either <code>C</code> if no new SCCs have been split out, or it will be the new SCC containing <code>N</code>. </p>

<p class="definition">Definition at line <a class="el" href="CGSCCPassManager_8cpp_source.html#l00366">366</a> of file <a class="el" href="CGSCCPassManager_8cpp_source.html">CGSCCPassManager.cpp</a>.</p>

<p class="reference">References <a class="el" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert()</a>, <a class="el" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <a class="el" href="CGSCCPassManager_8h_source.html#l00256">llvm::CGSCCUpdateResult::CWorklist</a>, <a class="el" href="Debug_8cpp_source.html#l00132">llvm::dbgs()</a>, <a class="el" href="MD5_8cpp_source.html#l00056">G</a>, <a class="el" href="PassManager_8h_source.html#l00795">llvm::AnalysisManager&lt; IRUnitT, ExtraArgTs &gt;::getCachedResult()</a>, <a class="el" href="PassManager_8h_source.html#l00848">llvm::AnalysisManager&lt; IRUnitT, ExtraArgTs &gt;::invalidate()</a>, <a class="el" href="Debug_8h_source.html#l00122">LLVM_DEBUG</a>, <a class="el" href="iterator__range_8h_source.html#l00053">llvm::make_range()</a>, <a class="el" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="el" href="PassManager_8h_source.html#l00174">llvm::PreservedAnalyses::preserve()</a>, <a class="el" href="STLExtras_8h_source.html#l00273">llvm::reverse()</a>, and <a class="el" href="CGSCCPassManager_8cpp_source.html#l00321">updateNewSCCFunctionAnalyses()</a>.</p>

<p class="reference">Referenced by <a class="el" href="CGSCCPassManager_8cpp_source.html#l00426">llvm::updateCGAndAnalysisManagerForFunctionPass()</a>.</p>

</div>
</div>
<a id="a01907c1b6ed2149a74bf8ac740be7beb" name="a01907c1b6ed2149a74bf8ac740be7beb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01907c1b6ed2149a74bf8ac740be7beb">&#9670;&nbsp;</a></span>updateNewSCCFunctionAnalyses()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void updateNewSCCFunctionAnalyses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacellvm.html#abd17dd16e74c968cf01d3d32ea486696">CGSCCAnalysisManager</a> &amp;&#160;</td>
          <td class="paramname"><em>AM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When a new SCC is created for the graph and there might be function analysis results cached for the functions now in that SCC two forms of updates are required. </p>
<p >First, a proxy from the SCC to the FunctionAnalysisManager needs to be created so that any subsequent invalidation events to the SCC are propagated to the function analysis results cached for functions within it.</p>
<p >Second, if any of the functions within the SCC have analysis results with outer analysis dependencies, then those dependencies would point to the <em>wrong</em> SCC's analysis result. We forcibly invalidate the necessary function analyses so that they don't retain stale handles. </p>

<p class="definition">Definition at line <a class="el" href="CGSCCPassManager_8cpp_source.html#l00321">321</a> of file <a class="el" href="CGSCCPassManager_8cpp_source.html">CGSCCPassManager.cpp</a>.</p>

<p class="reference">References <a class="el" href="PassManager_8h_source.html#l00159">llvm::PreservedAnalyses::all()</a>, <a class="el" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <a class="el" href="MD5_8cpp_source.html#l00055">F</a>, <a class="el" href="MD5_8cpp_source.html#l00056">G</a>, <a class="el" href="PassManager_8h_source.html#l00776">llvm::AnalysisManager&lt; IRUnitT, ExtraArgTs &gt;::getResult()</a>, and <a class="el" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.</p>

<p class="reference">Referenced by <a class="el" href="CGSCCPassManager_8cpp_source.html#l00366">incorporateNewSCCRange()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jul 13 2022 11:25:11 for LLVM by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
